<!DOCTYPE html>
<html>
<head>
<title>Authentication - Bandipur House</title>
<meta name="google-signin-client_id" content="310627469637-tuatmhc8jsu2cbh1qplbtit6vmcmnovp.apps.googleusercontent.com">
<meta name="viewport" content="width=device-width,;initial-scale=1">
<script src="https://apis.google.com/js/platform.js" async defer></script>
<style>
body {
padding-top: 100px;
padding-left: 20px;
padding-right: 20px;
  text-align: center;
  color: white;
  font-family: Arial, Helvetica, sans-serif;
  background-image: url("https://loflabs.github.io/new.jpg");background-repeat: repeat;
}

h2{ 
  color: red;
}


.center {
  margin: auto;
  width: 50%;
  padding: 10px;
  border-radius: 10px;
}

.card {
padding: 10px;
  box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
  transition: 0.3s;
  width: 50%;
  border-radius: 25px;
background : black;
}

.card:hover {
  box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
}

.container {
  padding: 2px 16px;
}

#top, #bottom, #left, #right { 	background: rgb(78, 125, 150); 	position: fixed; 	} 	#left, #right { 		top: 0; bottom: 0; 		width: 10px; 		} 		#left { left: 0; } 		#right { right: 0; } 		 	#top, #bottom { 		left: 0; right: 0; 		height: 10px; 		} 		#top { top: 0; } 		#bottom { bottom: 0; }

</style>

</head>

<body oncontextmenu="return false" onkeydown="return false;" onmousedown="return false;">

<div id = "i"><img src = 'https://iconsplace.com/wp-content/uploads/_icons/ff0000/256/png/error-icon-14-256.png'></div>

<center id  = "s">
<div class = "card" >

<h1 id = "he"></h1>

<div class = "center">
<center>
<img id = "imgg"></img><div class = "center"></div>

</center>
</div>



</div>
<p id = "info" style = "color: black;">Sign in to Continue</p>
<p id = "test" style = "font-size: 14px;color: black;" ></p>
<br>
<br>
<div class="g-signin2" data-onsuccess="onSignIn"></div><br><br><button onclick="signOut();">Sign out</button>


<br><br><hr><br><br>
<div id = "bot">
<div class = "card" >
  <p id = "info1">You Belong to Group : </p>
</div>
<br>
<div style="padding: 20px">
  <p style = "color: black;">
In case you haven't connected with the Group Leader of <b><p id = "g" style = "color: black;"></p></b> please contact the WebAdmin at <a>bandipurwebad@student.onlinedegree.iitm.ac.in</a></p></div>
</div>
</center>



<div id="left"></div>
<div id="right"></div>
<div id="bottom"></div>
<div id="top"></div>

<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase.js"></script>

<script>

  document.getElementById("bot").style.visibility = "hidden";

  var firebaseConfig = {
    apiKey: "AIzaSyB-JgzYvrruZ5aVNkAUcJktNg4n6WqdtCo",
    authDomain: "lof-fnunho.firebaseapp.com",
    databaseURL: "https://lof-fnunho.firebaseio.com",
    projectId: "lof-fnunho",
    storageBucket: "lof-fnunho.appspot.com",
    messagingSenderId: "174519711144",
    appId: "1:174519711144:web:b7a2234ef431c7d1c5599d"
  };

  document.addEventListener('contextmenu', event => event.preventDefault());

if (false && window.name != "login-erjbewwewbewgw"){
document.getElementById("s").remove();
alert1();
}
else{
document.getElementById("i").remove();
document.getElementById("h").innerHTML = window.name;

}

document.getElementById("he").innerHTML = "Signed out";


function onSignIn(googleUser) {

    var profile = googleUser.getBasicProfile();

    var flag = true;
    
    if (profile.getEmail().includes("@student.onlinedegree.iitm.ac.in")){
    
    window.alert("sign in successful");

    var head = profile.getEmail().split("@")[0];


    document.getElementById('test').innerHTML = profile.getEmail();

    document.getElementById('he').innerHTML = "Signed in";
    
    document.getElementById('info').innerHTML = "";
    
    document.getElementById('imgg').src = profile.getImageUrl();
    
    document.getElementById('info').innerHTML = profile.getName();

    firebase.initializeApp(firebaseConfig);
    var rootRef = firebase.database().ref();
    var urlRef = rootRef.child("0/" + head);
    urlRef.once("value", function(snapshot) {
    
    document.getElementById('info1').innerHTML = "You Belong to group : <b>" + snapshot.val() + "</b>";

    document.getElementById('g').innerHTML = snapshot.val();

    document.getElementById("bot").style.visibility = "visible";

    
  });


    }
    
    else{
    
    	window.alert("Sign in with your Student Mail...");
        
        signOut();
    }

}



function signOut() {

    var auth2 = gapi.auth2.getAuthInstance();
    
    auth2.signOut().then(function () {
    
      console.log('User signed out.');
      
    } );

    document.getElementById('test').innerHTML = "";

    document.getElementById('he').innerHTML = "Signed out";
    
    document.getElementById('info').innerHTML = "Sign in to Continue";
    
    document.getElementById('imgg').src = '';
    
  
  }

  function alert1() {
            var x = document.createElement("h2");
            var t = 
                document.createTextNode("Open this portal only from the official source ");
            x.appendChild(t);
            document.body.appendChild(x);
        }


</script>

</body>

</html>
